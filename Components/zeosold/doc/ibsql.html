<html>
<head>
<title>Zeos Database Objects Interbase SQL components</title>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=Win1251">
</head>

<body link="#00637b" alink="#00637B" vlink="#000000">

<center>
<table width="100%" border="0" cellpading="0" cellspacing="0">
<tr>
<td bgcolor="#00637B" align=center valign=center>
<font color="White" size="6"><b>ZEOS Database Objects<br>
</b></font>
<font color="White" size="6"><b>Interbase SQL Components</b></font>
</tr>
</table>
<a name="Contents"></a>
<h2>Contents</h2>
</center>
<a name="Contents"></a>
<ul>
<li><a href="#Database">TZIbSQLDatabase</a> - component for connection to the Interbase SQL database
<li><a href="#Monitor">TZIbSQLMonitor</a> - component for tracing of outgoing queries
<li><a href="#Query">TZIbSQLQuery</a> - component for perfoming queries to Interbase SQL server
<li><a href="#Table">TZIbSQLTable</a> - component for representing SQL query as a TTable
<li><a href="#Transact">TZIbSQLTransact</a> - component of server transactions
</ul>
<hr>
<a name="Database"></a>
<center>
<h2><b>TZIbSQLDatabase</b></h2>
<a href="#Database_property"><font size=2> Properties |</font></a>
<a href="#Database_methods"><font size=2> Methods |</font></a>
<a href="#Database_events"><font size=2> Events </font></a>
</center>
<p>
Component for connections to the Interbase SQL database server. The dynamic load library <b>gds32.dll</b> is necessary.
<p>
Hierarchy: TObject->TPersistent->TComponent->TZDatabase->TZIbSQLDatabase
<p>
<a name="Database_property"></a>
<table width="100%" border="1" cellpading="0" cellspacing="0">
<tr bgcolor="#00637B" align=center valign=center>
<td colspan=2 align=center valign=center><font color="White">
TZIbSQLDatabase properties
</font>
</tr>
<tr>
<td width=30%><b>Handle:TDirConnect</b>
<td>Descriptor of direct connection to the database
</tr>
<tr>
<td><b>Host:ShortString</b>
<td>Interbase SQL database server host name
</tr>
<tr>
<td><b>Database:ShortString</b>
<td>Database name
</tr>
<tr>
<td><b>Login:ShortString</b>
<td>User name for connection
</tr>
<tr>
<td><b>Password:ShortString</b>
<td>Password for connection to the database
</tr>
<tr>
<td><b>LoginPromt:Boolean</b>
<td>When the value is switched to <b>true</b>, window for entering user name and password appears.
</tr>
<tr>
<td><b>Port:ShortString</b>
<td>Port number for connection to Interbase SQL server
</tr>
<tr>
<td><b>Connected:Boolean</b>
<td>Indicates the connection to database. When the value is switched to <b>true</b>,
 connection to the database occurs. Method <b>Connect</b> does the same.
</tr>
<tr>
<td><b>SqlDialect:Word</b>
<td>Determines the version of the SQL dialect.
Value 1 corresponds to the versions SQL 4.0, 5.0, 5.5. Value 3 - new SQL syntax a version 6.0. 
</tr>
<tr>
<td><b>Params:TStrings</b>
<td>Specifies the additional parameters for connection to a database.
 See documentation of Interbase for more.
</tr>

</table>
<center>
<font size=2>
<a href="#Database">Back | </a>
<a href="#Contents">Contents </a>
</font>
</center>
<p>
<a name="Database_methods"></a>
<table width="100%" border="1" cellpading="0" cellspacing="0">
<tr bgcolor="#00637B" align=center valign=center>
<td colspan=2 align=center valign=center><font color="White">
TZIbSQLDatabase methods
</font>
</tr>
<tr>
<td width=30%><b>procedure Connect()</b>
<td>Connects to the database
</tr>
<tr>
<td><b>procedure Disconnect()</b>
<td>Disconnects from the database
</tr>
</table>
<center>
<font size=2>
<a href="#Database">Back | </a>
<a href="#Contents">Contents </a>
</font>
</center>
<p>
<a name="Database_events"></a>
<table width="100%" border="1" cellpading="0" cellspacing="0">
<tr bgcolor="#00637B" align=center valign=center>
<td colspan=2 align=center valign=center><font color="White">
TZIbSQLDatabase events
</font>
</tr>
<tr>
<td width=30%><b>procedure AfterConnect(Sender:TObject)</b>
<td>Occurs after an application completes connecting to a database
</tr>
<tr>
<td><b>procedure AfterDisconnect(Sender:TObject)</b>
<td>Occurs after an application completes disconnecting from a database
</tr>
<tr>
<td><b>procedure BeforeConnect(Sender:TObject)</b>
<td>Occurs before an application completes connecting to a database
</tr>
<tr>
<td><b>procedure BeforeDisconnect(Sender:TObject)</b>
<td>Occurs before an application completes disconnecting from a database
</tr>
</table>
<center>
<font size=2>
<a href="#Database">Back | </a>
<a href="#Contents">Contents </a>
</font>
</center>

<hr>
<a name="Monitor"></a>
<center>
<h2><b>TZIbSQLMonitor</b></h2>
<a href="#Monitor_events"><font size=2> Events </font></a>
</center>
<p>
Component for the tracing of an outgoing queries. It have the one event, 
which occurs when any SQL queries is processed by Interbase SQL server. It returns
the outgoing query and its result.
<p>
Hierarchy: TObject->TPersistent->TComponent->TZMonitor->TZIbSQLMonitor
<p>
<a name="Monitor_events"></a>
<table width="100%" border="1" cellpading="0" cellspacing="0">
<tr bgcolor="#00637B" align=center valign=center>
<td colspan=2 align=center valign=center><font color="White">
TZIbSQLMonitor events
</font>
</tr>
<tr>
<td width=30%><b>procedure MonitorEvent(Sql, Result: String)</b>
<td>Event occurs when Interbase SQL server have processed the query.
 The returning values:
<ul>
<li><b>Sql</b> - text of the outgoing query 
<li><b>Result</b> - the result, which includes errors and time of processing.
</ul>
</tr>
</table>
<center>
<font size=2>
<a href="#Monitor">Back | </a>
<a href="#Contents">Contents </a>
</font>
</center>


<hr><a name="Query"></a>
<center>
<h2><b>TZIbSQLQuery</b></h2>
<a href="#Query_property"><font size=2> Properties |</font></a>
<a href="#Query_methods"><font size=2> Methods |</font></a>
<a href="#Query_events"><font size=2> Events </font></a>
</center>
<p>
Component for perfoming SQL queries to Interbase SQL server.
It's used for sending SQL statements to Interbase SQL server.
пересылки выражений SQL запросов Interbase SQL серверу. 
The results of processing is available to use with the standart TDataSource.
The records can be added, deleted or changed.
<p>
Hierarchy: TObject->TPersistenet->TComponent->TDataSet->TZDataSet->
TZCustomInterbase SQLDataSet->TZIbSQLQuery
<p>
<a name="Query_property"></a>
<table width="100%" border="1" cellpading="0" cellspacing="0">
<tr bgcolor="#00637B" align=center valign=center>
<td colspan=2 align=center valign=center><font color="White">
TZIbSQLQuery properties
</font>
</tr>
<tr>
<td width=30%><b>Active:Boolean</b>
<td>Indicates the query is opened. When the value is switched to <b>true</b>, 
query will be opened. For query like 'SELECT' only.
</tr>
<tr>
<td><b>AutoCalcFields:Boolean</b>
<td>Determines when the OnCalcFields event is triggered.
</tr>
<tr>
<td><b>CachedUpdates:Boolean</b>
<td>Specifies whether cached updates are enabled
</tr>
<tr>
<td><b>DataBase:TZIbSQLDatabase</b>
<td>Identifies the database component
</tr>
<tr>
<td><b>DataSource:TDataSource</b>
<td>Identifies DataSource for access
</tr>
<tr>
<td><b>ExtraOptions:TInterbase SQLOptions</b>
<td>The set of the special options:
<ul>
<li><b>moStoreResult</b> - indicates the method for using the query.
If value is switched to <b>true</b>(default), then the result of the query
completely transmitts to a client and the connection to database is free for other queries.
Otherwise, the connection to the database is blocked till end of processing of the query.
In this case less memory is needed.
<li><b>moUseGen</b> - determines using of generators
</ul>
</tr>
<tr>
<td><b>Filter:ShortString</b>
<td>Specifies the text of the current filter for a dataset.
</tr>
<tr>
<td><b>Filtered:Boolean</b>
<td>Specifies whether filtering is active for a dataset.
</tr>
<tr>
<td><b>FilterOptions:TFilterOptions</b>
<td>Specifies filters is:
<ul>
<li><b>foCaseInsensitive</b> - whether filtering is case insensitive
<li><b>foNoPartialCompare</b> - whether or not partial comparisons are permitted when filtering records
</ul>
</tr>
<tr>
<td><b>LinkFields</b>
<td>The Wizard of relationships of queries
</tr>
<tr>
<td><b>LinkOptions:TZLinkOptions</b>
<td>The set of options for linking fileds
<ul>
<li><b>loLinkRequery</b> - determines wheter or not link reguery
<li><b>loCascadeUpdate</b> - determines cascade renovation of data
<li><b>loCascadeDelete</b> - determines cascade removing
<li><b>loAlwaysResync</b> - determines sinchronization
</ul>
</tr>
<tr>
<td><b>MasterSource:TDataSource</b>
<td>Indicates the master DataSource for linking of fields
</tr>
<tr>
<td><b>Options:TZDatabaseOptions</b>
<td>Extended options
<ul>
<li><b>doParamAsIs</b> - determines processing parameters in their primary representation
<li><b>doHourGlass</b> - determines whether or not to display a sand clock while query is processing
<li><b>doQueryAllRecords</b> - determines to process all records
<li><b>doCheckNulls</b> - determines check nulls values
<li><b>doCalcDefault</b> - determines calculation by default
</ul>
</tr>
<tr>
<td><b>ParamCount:Word</b>
<td>Indicates the current number of parameters for the query.
</tr>
<tr>
<td><b>Params:TParams</b>
<td>Contains the parameters for a query's SQL statement.
</tr>
<tr>
<td><b>ParamCheck:Boolean</b>
<td>Specifies whether the parameter list for a query is regenerated
</tr>
<tr>
<td><b>RequestLive:Boolean</b>
<td>Specifies whether or not a query result is read-only 
</tr>

<tr>
<td><b>RecordCount:LongInt</b>
<td>Indicates the total number of records associated with the dataset.
</tr>
<tr>
<td><b>ShowRecordTypes</b>
<td>The parameters of records, which determines to show:
<ul>
<li><b>rtModified</b> - all modified records
<li><b>rtInserted</b> - all added records
<li><b>rtDeleted</b> - all deleted records
<li><b>rtUnmodified</b> - all unmodified records
</ul>
</tr>
<tr>
<td><b>Sql:TStringList</b>
<td>Contains the text of the SQL statement to execute for the query
</tr>
<tr>
<td><b>Transaction:TZIbSQLTransact</b>
<td>Indicates Transact component
</tr>
<tr>
<td><b>UpdateObject:TZUpdateSQL</b>
<td>Specifies the update object component used to update a read-only result set when cached updates are enabled.
</tr>
</table>
<center>
<font size=2>
<a href="#Query">Back | </a>
<a href="#Contents">Contents </a>
</font>
</center>
<p>
<a name="Query_methods"></a>
<table width="100%" border="1" cellpading="0" cellspacing="0">
<tr bgcolor="#00637B" align=center valign=center>
<td colspan=2 align=center valign=center><font color="White">
TZIbSQLQuery methods
</font>
</tr>
<tr>
<td width=40%><b>procedure ExecSql;</b>
<td>Executes the SQL statement for the query. Use ExecSQL to execute queries that do not return a cursor to data (such as INSERT, UPDATE, DELETE, and CREATE TABLE).
</tr>
<tr>
<td><b>function  RowsAffected: LongInt;</b>
<td>Returns the number of rows operated upon by the latest query execution.
</tr>
<tr>
<td><b>procedure SortInverse;</b>
<td>Inverts rules for sorting of the records
</tr>
<tr>
<td><b>procedure SortClear;</b>
<td>Removes rules for sorting of the records
</tr>
<tr>
<td><b>procedure SortByField(FieldName: string);</b>
<td>Sorts all record by field
</tr>
<tr>
<td><b>procedure SortDescByField(FieldName: string);</b>
<td>Sorts all record by field descanding
</tr>
<tr>
<td><b>function Locate(const KeyFields: string; const KeyValues: Variant;
Options: TLocateOptions): Boolean;</b>
<td>Searches the dataset for a specified record and makes that record the current record.
Options is a set that optionally specifies additional search latitude when searching on string fields.
<ul>
<li><b>loCaseInsensitive</b> - Key fields and key values are matched without regard to case
<li><b>loPartialKey</b> - Key values can include only part of the matching key field value
</ul>
Returns True if it finds a matching record,
</tr>
<tr>
<td><b>function  Lookup(const KeyFields: string; const KeyValues: Variant;
      const ResultFields: string): Variant;</b>
<td>
Retrieves field values from a record that matches specified search values, like Locate.
</tr>
<tr>
<td><b>function  IsSequenced: Boolean;</b>
<td>Indicates whether sequence numbers are available for database records.
</tr>
<tr>
<td><b>procedure ApplyUpdates;</b>
<td>Writes a dataset's pending cached updates to the database
</tr>
<tr>
<td><b>procedure CommitUpdates;</b>
<td>
Clears the cached updates buffer.
</tr>
<tr>
<td><b>procedure CancelUpdates;</b>
<td>Clears all pending cached updates from the cache and restores the dataset its prior state.
</tr>
<tr>
<td><b>procedure RevertRecord;</b>
<td>Restores the current record in the dataset to an unmodified state when cached updates are enabled.
</tr>
<tr>
<td><b>function  ParamByName(const Value: string): TParam;</b>
<td>Accesses parameter information based on a specified parameter name.
</tr>
<tr>
<td><b>function  CreateBlobStream(Field: TField; Mode: TBlobStreamMode): TStream;</b>
<td>Provides the interface for a method that creates a blob stream for a Binary large object (BLOB) field in the dataset.
<ul>
<li><b>bmRead</b> - The stream is used to read from a BLOB field.
<li><b>bmWrite</b> - The stream is used to write to a BLOB field.
<li><b>bwReadWrite</b> - The stream is used to modify a BLOB field's value.
</ul>
</tr>
<tr>
<td><b>procedure SaveToStream(Stream: TStream);</b>
<td>Saves the contents of a Dataset to a stream.
</tr>
<tr>
<td><b>procedure LoadFromStream(Stream: TStream);</b>
<td>Loads a stream into the Dataset.
</tr>
<tr>
<td><b>procedure SaveToFile(FileName: string);</b>
<td>Saves a dataset's data to an external file.
</tr>
<tr>
<td><b>procedure LoadFromFile(FileName: string);</b>
<td>Loads a dataset's data from a file.
</tr>
</table>
<center>
<font size=2>
<a href="#Query">Back | </a>
<a href="#Contents">Contents </a>
</font>
</center>
<p>
<a name="Query_events"></a>
<table width="100%" border="1" cellpading="0" cellspacing="0">
<tr bgcolor="#00637B" align=center valign=center>
<td colspan=2 align=center valign=center><font color="White">
TZIbSQLQuery events
</font>
</tr>
<tr>
<td width=45%><b>procedure AfterCancel(DataSet: TDataSet);</b>
<td>Occurs after an application completes a request to cancel modifications to the current record.
</tr>
<tr>
<td><b>procedure AfterClose(DataSet: TDataSet);</b>
<td>Occurs after an application closes a dataset.
</tr>
<tr>
<td><b>procedure AfterDelete(DataSet: TDataSet);</b>
<td>Occurs after an application deletes a record.
</tr>
<tr>
<td><b>procedure AfterEdit(DataSet: TDataSet);</b>
<td>Occurs after an application deletes a record.
</tr>
<tr>
<td><b>procedure AfterInsert(DataSet: TDataSet);</b>
<td>Occurs after an application inserts a new record.
</tr>
<tr>
<td><b>procedure AfterOpen(DataSet: TDataSet);</b>
<td>Occurs after an application completes opening a dataset and before any data access occurs.
</tr>
<tr>
<td><b>procedure AfterPost(DataSet: TDataSet);</b>
<td>Occurs after an application writes the current record to the database or cache and before the dataset is returned to browse state.
</tr>
<tr>
<td><b>procedure AfterScroll(DataSet: TDataSet);</b>
<td>Occurs after an application scrolls from one record to another.
</tr>
<tr>
<td><b>procedure BeforeCancel(DataSet: TDataSet);</b>
<td>Occurs before an application executes a request to cancel changes to the current record.
</tr>
<tr>
<td><b>procedure BeforeClose(DataSet: TDataSet);</b>
<td>Occurs before an application executes a request to close the dataset.
</tr>
<tr>
<td><b>procedure BeforeDelete(DataSet: TDataSet);</b>
<td>Occurs before an application attempts to delete the current record.
</tr>
<tr>
<td><b>procedure BeforeEdit(DataSet: TDataSet);</b>
<td>Occurs before an application enters edit mode for the current record.
</tr>
<tr>
<td><b>procedure BeforeInsert(DataSet: TDataSet);</b>
<td>Occurs before an application enters insert mode.
</tr>
<tr>
<td><b>procedure BeforeOpen(DataSet: TDataSet);</b>
<td>Occurs before an application executes a request to open a dataset.
</tr>
<tr>
<td><b>procedure BeforePost(DataSet: TDataSet);</b>
<td>Occurs before an application posts changes for the current record to the database or cache.
</tr>
<tr>
<td><b>procedure BeforeScroll(DataSet: TDataSet);</b>
<td>Occurs before an application scrolls from one record to another.
</tr>
<tr>
<td><b>procedure ApplyUpdateError(DataSet: TDataSet; E: EDatabaseError; var Action: TDataAction);</b>
<td>Occurs if an exception is generated when cached updates are applied to a database.
</tr>
<tr>
<td><b>procedure CalcFields(DataSet: TDataSet);</b>
<td>Occurs when an application recalculates calculated fields.
</tr>
<tr>
<td><b>procedure DeleteError(DataSet: TDataSet; E: EDatabaseError; var Action: TDataAction);</b>
<td>Occurs when an application attempts to delete a record and an exception is raised.
</tr>
<tr>
<td><b>procedure EditError(DataSet: TDataSet; E: EDatabaseError; var Action: TDataAction);</b>
<td>Occurs when an application attempts to modify or insert a record and an exception is raised.
</tr>
<tr>
<td><b>procedure FilterRecord(DataSet: TDataSet;var Accept: Boolean);</b>
<td>Occurs each time a different record in the dataset becomes the current record and filtering is enabled.
</tr>
<tr>
<td><b>procedure NewRecord(DataSet: TDataSet);</b>
<td>Occurs when an application inserts or appends a new dataset record.
</tr>
<tr>
<td><b>procedure PostError(DataSet: TDataSet; E: EDatabaseError; var Action: TDataAction);</b>
<td>Occurs when an application attempts to modify or insert a record and an exception is raised.
</tr>
<tr>
<td><b>procedure UpdateRecord(DataSet: TDataSet; UpdateKind: TUpdateKind; var UpdateAction: TUpdateAction);</b>
<td>Occurs if an exception is generated when cached updates are applied to a database.
</tr>
</table>
<center>
<font size=2>
<a href="#Query">Back | </a>
<a href="#Contents">Contents </a>
</font>
</center>
<p>

<hr>
<a name="Table"></a>
<center>
<h2><b>TZIbSQLTable</b></h2>
</center>
<p>
Component for processing the results of the query to Interbase SQL server in the manner of table.
<p>
Hierarchy: TObject->TPersistenet->TComponent->TDataSet->TZDataSet->
TZCustomInterbase SQLDataSet->TZIbSQLTable
<p>
Hasn't any principle differences from TZIbSQLQuery, but the following exclusions:
<br>
<ul>
<li>Properties Params, ParamCheck, ParamCount are removed
<li>Property DataSource is removed
<li>Instead of the property SQL is added property TableName, which indicates the name of table for the query.
Practically at the opening of table, occurs the transmission of request to the following SQL statement:<br>
"SELECT * FROM TableName" 
<li>Instead of the properties RequestLive is added the similar property ReadOnly, 
which changes the permit for editing contents of the table.
</ul>
<p>
<center>
<font size=2>
<a href="#Table">Back | </a>
<a href="#Contents">Contents </a>
</font>
</center>
<hr>
<a name="Transact"></a>
<center>
<h2><b>TZIbSQLTransact</b></h2>
<a href="#Transact_property"><font size=2> Properties |</font></a>
<a href="#Transact_methods"><font size=2> Methods |</font></a>
<a href="#Transact_events"><font size=2> Events </font></a>
</center>
<p>
Component for work with transactions of Interbase SQL server
<p>
Hierarchy: TObject->TPersistent->TComponent->TZTransact->TZIbSQLTransact
<a name="Transact_property"></a>
<table width="100%" border="1" cellpading="0" cellspacing="0">
<tr bgcolor="#00637B" align=center valign=center>
<td colspan=2 align=center valign=center><font color="White">
TZIbSQLTransact properties
</font>
</tr>
<tr>
<td width=30%><b>AutoCommit:Boolean</b>
<td>If of the value of this property is switched to <b>true</b>
 then updates will be apllied automatically. Otherwise is necessary to call
 <b>Commit</b> or <b>Rollback</b> manually.
</tr>
<tr>
<td><b>Connected:Boolean</b>
<td>Indicates the connection to a database
</tr>

<tr>
<td><b>Database:TZIbSQLDatabase</b>
<td>Specifies a database component
</tr>
<tr>
<td><b>Options:TZTransactOptions</b>
<td>The set of options:
<ul>
<li><b>toHourGlass</b> - determines to display a sand clock while transactions is procesing
</ul>
</tr>
<tr>
<td><b>Params:TStrings</b>
<td>Specifies the additional parameters for connection to the server
 See documentation of Interbase for more.
</tr>
</table>
<center>
<font size=2>
<a href="#Transact">Back | </a>
<a href="#Contents">Contents </a>
</font>
</center>
<p>
<a name="Transact_methods"></a>
<table width="100%" border="1" cellpading="0" cellspacing="0">
<tr bgcolor="#00637B" align=center valign=center>
<td colspan=2 align=center valign=center><font color="White">
TZIbSQLTransact methods
</font>
</tr>
<tr>
<td width=30%><b>procedure Connect</b>
<td>Connects to Interbase SQL server
</tr>
<tr>
<td><b>procedure Disconnect</b>
<td>Disconnects from Interbase SQL server
</tr>
<tr>
<td><b>procedure Commit</b>
<td>Updates all changes in the transaction buffer and its clear
</tr>
<tr>
<td><b>procedure RollBack</b>
<td>Rollback of transactions
</tr>
<tr>
<td><b>procedure DoApplyUpdates</b>
<td>Updates all changes from the transaction buffer
</tr>
</table>
<center>
<font size=2>
<a href="#Transact">Back | </a>
<a href="#Contents">Contents </a>
</font>
</center>
<p>
<a name="Transact_events"></a>
<table width="100%" border="1" cellpading="0" cellspacing="0">
<tr bgcolor="#00637B" align=center valign=center>
<td colspan=2 align=center valign=center><font color="White">
TZIbSQLTransact events
</font>
</tr>
<tr>
<td width=30%><b>procedure OnApplyUpdates(Sender:TObject)</b>
<td>Occurs when an application applies all changes from the transaction buffer
</tr>
<tr>
<td><b>procedure OnCommit(Sender:TObject)</b>
<td>Occurs when an application calls Commit method 
</tr>
<tr>
<td><b>procedure OnDataChange(Sender:TObject)</b>
<td>Occurs when contents of the database is changed
</tr>
<tr>
<td><b>procedure OnRollBack(Sender:TObject)</b>
<td>Occurs when an apllication calls Rollback method
</tr>

</table>
<center>
<font size=2>
<a href="#Transact">Back | </a>
<a href="#Contents">Contents </a>
</font>
</center>


<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;

</center>
</body>
</html>